<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Descriptive • vigicaen</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Descriptive">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vigicaen</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.16.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/getting_started.html">Getting started</a></li>
    <li><a class="dropdown-item" href="../articles/basic_workflow.html">Basic Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/routine_pharmacovigilance.html">Routine pharmacovigilance</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Going further</h6></li>
    <li><a class="dropdown-item" href="../articles/descriptive.html">Descriptive</a></li>
    <li><a class="dropdown-item" href="../articles/interactions.html">Interactions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Script templates</h6></li>
    <li><a class="dropdown-item" href="../articles/template_dictionary.html">Dictionary</a></li>
    <li><a class="dropdown-item" href="../articles/template_main.html">Data management and disproportionality</a></li>
    <li><a class="dropdown-item" href="../articles/template_routine.html">Routine</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pharmacologie-caen/vigicaen/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Descriptive</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pharmacologie-caen/vigicaen/blob/master/vignettes/descriptive.Rmd" class="external-link"><code>vignettes/descriptive.Rmd</code></a></small>
      <div class="d-none name"><code>descriptive.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div class="section level3">
<h3 id="objectives">Objectives<a class="anchor" aria-label="anchor" href="#objectives"></a>
</h3>
<ul>
<li><p>Compute descriptive statistics on a (vigibase) dataset</p></li>
<li><p>Understand the structure of the <code>link</code> table</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="prerequisite">Prerequisite<a class="anchor" aria-label="anchor" href="#prerequisite"></a>
</h3>
<ul>
<li>Be familiar with data management on drugs and adrs, with the
<code>get_*</code> and <code>add_*</code> functions (see
<code><a href="../articles/basic_workflow.html">vignette("basic_workflow")</a></code>)</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="demo-data-counts-of-drugs-adrs-case-characteristics">Demo data: counts of drugs, adrs, case characteristics<a class="anchor" aria-label="anchor" href="#demo-data-counts-of-drugs-adrs-case-characteristics"></a>
</h2>
<div class="section level3">
<h3 id="step-0-load-packages">Step 0: Load packages<a class="anchor" aria-label="anchor" href="#step-0-load-packages"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pharmacologie-caen/vigicaen" class="external-link">vigicaen</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rlang.r-lib.org" class="external-link">rlang</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-1-load-datasets-and-add-drug-and-adr-columns">Step 1: Load datasets and add drug and adr columns<a class="anchor" aria-label="anchor" href="#step-1-load-datasets-and-add-drug-and-adr-columns"></a>
</h3>
<p>This vignette uses the preloaded datasets (and a spurious suspdup
table).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">demo</span>     <span class="op">&lt;-</span> <span class="va">demo_</span></span>
<span><span class="va">adr</span>      <span class="op">&lt;-</span> <span class="va">adr_</span></span>
<span><span class="va">drug</span>     <span class="op">&lt;-</span> <span class="va">drug_</span></span>
<span><span class="va">link</span>     <span class="op">&lt;-</span> <span class="va">link_</span></span>
<span><span class="va">out</span>      <span class="op">&lt;-</span> <span class="va">out_</span></span>
<span><span class="va">followup</span> <span class="op">&lt;-</span> <span class="va">followup_</span></span>
<span></span>
<span><span class="va">srce</span>     <span class="op">&lt;-</span> <span class="va">srce_</span></span>
<span></span>
<span><span class="va">thg</span>      <span class="op">&lt;-</span> <span class="va">thg_</span></span>
<span><span class="va">mp</span>       <span class="op">&lt;-</span> <span class="va">mp_</span></span>
<span><span class="va">meddra</span>   <span class="op">&lt;-</span> <span class="va">meddra_</span></span>
<span><span class="va">smq_list</span> <span class="op">&lt;-</span> <span class="va">smq_list_</span></span>
<span><span class="va">smq_content</span> <span class="op">&lt;-</span> <span class="va">smq_content_</span></span>
<span></span>
<span><span class="va">suspdup</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>    UMCReportId <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    SuspectedduplicateReportId <span class="op">=</span> <span class="cn">NA</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>And preloaded drug and adr dictionaries.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_drecno</span> <span class="op">&lt;-</span> <span class="va">ex_</span><span class="op">$</span><span class="va">d_drecno</span></span>
<span></span>
<span><span class="va">a_llt</span> <span class="op">&lt;-</span> <span class="va">ex_</span><span class="op">$</span><span class="va">a_llt</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">demo</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">demo</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_drug.html">add_drug</a></span><span class="op">(</span></span>
<span>    d_code <span class="op">=</span> <span class="va">d_drecno</span>,</span>
<span>    drug_data <span class="op">=</span> <span class="va">drug</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> `.data` detected as `demo` table.</span></span>
<span></span>
<span><span class="va">demo</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">demo</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_adr.html">add_adr</a></span><span class="op">(</span></span>
<span>    a_code <span class="op">=</span> <span class="va">a_llt</span>,</span>
<span>    adr_data <span class="op">=</span> <span class="va">adr</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> `.data` detected as `demo` table.</span></span></code></pre></div>
<p>As we aim to describe drug and adr counts, but also other variables
(age, sex, type of reporter), they will be added too.</p>
<p>You can still refer to </p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Age, sex</span></span>
<span></span>
<span><span class="va">demo</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">demo</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">AgeGroup</span><span class="op">)</span>,</span>
<span>              breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span><span class="op">)</span>,</span>
<span>              include.lowest <span class="op">=</span> <span class="cn">TRUE</span>, right <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"&lt;18"</span>, <span class="st">"18-45"</span>,<span class="st">"45-64"</span>, <span class="st">"65-74"</span>, <span class="st">"75+"</span><span class="op">)</span><span class="op">)</span>,</span>
<span></span>
<span>    sex <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">Gender</span> <span class="op">==</span> <span class="st">"1"</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>                    <span class="va">Gender</span> <span class="op">==</span> <span class="st">"2"</span> <span class="op">~</span> <span class="fl">2</span>,</span>
<span>                    <span class="va">Gender</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-"</span>,<span class="st">"0"</span>,<span class="st">"9"</span><span class="op">)</span> <span class="op">~</span> <span class="cn">NA_real_</span>,</span>
<span>                    <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_real_</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Death + outcome availability</span></span>
<span></span>
<span><span class="va">demo</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">demo</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>death <span class="op">=</span> </span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">UMCReportId</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">out</span><span class="op">$</span><span class="va">UMCReportId</span>,</span>
<span>                  <span class="va">UMCReportId</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>                    <span class="op">(</span><span class="va">out</span> <span class="op">|&gt;</span> </span>
<span>                    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Seriousness</span> <span class="op">==</span> <span class="st">"1"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">UMCReportId</span><span class="op">)</span></span>
<span>                    <span class="op">)</span>,</span>
<span>                  <span class="cn">NA</span><span class="op">)</span></span>
<span>         <span class="op">)</span></span>
<span></span>
<span><span class="co"># follow-up, seriousness</span></span>
<span></span>
<span><span class="va">demo</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">demo</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    fup <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">UMCReportId</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">followup</span><span class="op">$</span><span class="va">UMCReportId</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>    serious <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span></span>
<span>        <span class="va">UMCReportId</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">out</span><span class="op">$</span><span class="va">UMCReportId</span>,</span>
<span>        <span class="va">UMCReportId</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>          <span class="op">(</span><span class="va">out</span> <span class="op">|&gt;</span> </span>
<span>          <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Serious</span> <span class="op">==</span> <span class="st">"Y"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>          <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">UMCReportId</span><span class="op">)</span></span>
<span>          <span class="op">)</span>,</span>
<span>        <span class="cn">NA</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># year</span></span>
<span></span>
<span><span class="va">demo</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">demo</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">FirstDateDatabase</span>, start <span class="op">=</span> <span class="fl">1</span>, stop <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># type of reporter</span></span>
<span></span>
<span><span class="va">demo</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">demo</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span></span>
<span>    <span class="va">srce</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/transmute.html" class="external-link">transmute</a></span><span class="op">(</span><span class="va">UMCReportId</span>, type_reporter <span class="op">=</span> <span class="va">Type</span><span class="op">)</span>,</span>
<span>    by <span class="op">=</span> <span class="st">"UMCReportId"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="desc_facvar">
<code>desc_facvar()</code><a class="anchor" aria-label="anchor" href="#desc_facvar"></a>
</h3>
<p><code><a href="../reference/desc_facvar.html">desc_facvar()</a></code> generates a summary of categorical
variables with 2 or more levels.</p>
<p>Its <code>.data</code> argument is a dataset to describe. Described
variables should be passed to <code>vf</code>, as a character
vector.</p>
<div class="section level4">
<h4 id="multi-level-variables">Multi-level variables<a class="anchor" aria-label="anchor" href="#multi-level-variables"></a>
</h4>
<p>Let’s take the <code>demo</code> dataset as an example, with variable
“age”.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/desc_facvar.html">desc_facvar</a></span><span class="op">(</span></span>
<span>  .data <span class="op">=</span> <span class="va">demo</span>,</span>
<span>  vf <span class="op">=</span> <span class="st">"age"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 4</span></span></span>
<span><span class="co">#&gt;   var   level value           n_avail</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> age   &lt;18   <span style="color: #949494;">"</span> 1/499 (0%) <span style="color: #949494;">"</span>      499</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> age   18-45 <span style="color: #949494;">"</span>43/499 (9%) <span style="color: #949494;">"</span>      499</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> age   45-64 <span style="color: #949494;">"</span>173/499 (35%)<span style="color: #949494;">"</span>     499</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> age   65-74 <span style="color: #949494;">"</span>174/499 (35%)<span style="color: #949494;">"</span>     499</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> age   75+   <span style="color: #949494;">"</span>108/499 (22%)<span style="color: #949494;">"</span>     499</span></span></code></pre></div>
<p>The output format is a <code>data.frame</code>, of class
<code>tibble</code>.</p>
<p>The first column, <code>var</code>, contains the name of the variable
of interest. The second column, <code>level</code>, contains the level
of the variable.</p>
<p>In this example, the first line shows the number of patients whose
age variable (<code>var</code>) is “&lt;18”, i.e. patients under 18
years old.</p>
<p>The percentage appears in the <code>value</code> column, after the
count of cases and the total number of reports for which the information
is available.</p>
<p>This number of reports with available information is recalled in the
<code>n_avail</code> column.</p>
</div>
<div class="section level4">
<h4 id="binary-variables">Binary variables<a class="anchor" aria-label="anchor" href="#binary-variables"></a>
</h4>
<p>What happens when the variable has only two levels, for example 1 and
0, as is often the case for the drug and adr variables?</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/desc_facvar.html">desc_facvar</a></span><span class="op">(</span></span>
<span>  .data <span class="op">=</span> <span class="va">demo</span>,</span>
<span>  vf <span class="op">=</span> <span class="st">"nivolumab"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">#&gt;   var       level value         n_avail</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> nivolumab 0     525/750 (70%)     750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> nivolumab 1     225/750 (30%)     750</span></span></code></pre></div>
<p>The output format is unchanged, with a data.frame as output.</p>
<p>The reading is unchanged: we get the count of cases of the variable
nivolumab, by its two levels. There are thus 225 patients exposed to
nivolumab, out of 750 reports in total, which represents 30% of
patients.</p>
<p>Conversely, 525 reports do not mention nivolumab.</p>
<p>In general, when presenting the results, the level 0 of binary
variables provides little information and can be omitted.</p>
</div>
<div class="section level4">
<h4 id="logical-variables">Logical variables<a class="anchor" aria-label="anchor" href="#logical-variables"></a>
</h4>
<p>Let’s continue with another example on the “seriousness” status.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/desc_facvar.html">desc_facvar</a></span><span class="op">(</span></span>
<span>  .data <span class="op">=</span> <span class="va">demo</span>,</span>
<span>  vf <span class="op">=</span> <span class="st">"serious"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">#&gt;   var     level value         n_avail</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> serious FALSE 181/747 (24%)     747</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> serious TRUE  566/747 (76%)     747</span></span></code></pre></div>
<p>The “serious” variable takes the values TRUE/FALSE, and not 1/0, but
it is interpreted in the same way (it is only an artifact of
construction).</p>
<p>Thus, 566 cases are considered serious, out of 747 where the
information is available.</p>
</div>
<div class="section level4">
<h4 id="exporting-raw-values">Exporting raw values<a class="anchor" aria-label="anchor" href="#exporting-raw-values"></a>
</h4>
<p>You can export to run plotting or other formatting functions, with
argument <code>export_raw_values</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/desc_facvar.html">desc_facvar</a></span><span class="op">(</span></span>
<span>  .data <span class="op">=</span> <span class="va">demo</span>,</span>
<span>  vf <span class="op">=</span> <span class="st">"nivolumab"</span>,</span>
<span>  export_raw_values <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 6</span></span></span>
<span><span class="co">#&gt;   var       level value         n_avail     n    pc</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> nivolumab 0     525/750 (70%)     750   525    70</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> nivolumab 1     225/750 (30%)     750   225    30</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="grouping-several-levels-of-a-variable">Grouping several levels of a variable<a class="anchor" aria-label="anchor" href="#grouping-several-levels-of-a-variable"></a>
</h3>
<p>What if the available categories do not match our final needs?</p>
<p>In the example on age, there is only one patient under 18 years old,
and few patients under 45 years old. We would like to group all this
data into a single line for a summary.</p>
<p>The solution is to create the variable with the desired levels
upstream, in a data management step.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">demo</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">demo</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    age2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">AgeGroup</span><span class="op">)</span>,</span>
<span>              breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>              include.lowest <span class="op">=</span> <span class="cn">TRUE</span>, right <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"&lt;64"</span>, <span class="st">"65-74"</span>, <span class="st">"75+"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/desc_facvar.html">desc_facvar</a></span><span class="op">(</span></span>
<span>  <span class="va">demo</span>,</span>
<span>  vf <span class="op">=</span> <span class="st">"age2"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 4</span></span></span>
<span><span class="co">#&gt;   var   level value         n_avail</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> age2  &lt;64   217/499 (43%)     499</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> age2  65-74 174/499 (35%)     499</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> age2  75+   108/499 (22%)     499</span></span></code></pre></div>
<p>The same is true for columns like “year”.</p>
<p>When studying the “year” column, it is common to get an error
message</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/desc_facvar.html">desc_facvar</a></span><span class="op">(</span></span>
<span>  .data <span class="op">=</span> <span class="va">demo</span>,</span>
<span>  vf <span class="op">=</span> <span class="st">"year"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 13 × 4</span></span></span>
<span><span class="co">#&gt;    var   level value           n_avail</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> year  2011  <span style="color: #949494;">"</span> 1/750 (0%) <span style="color: #949494;">"</span>      750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> year  2012  <span style="color: #949494;">"</span> 1/750 (0%) <span style="color: #949494;">"</span>      750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> year  2013  <span style="color: #949494;">"</span> 2/750 (0%) <span style="color: #949494;">"</span>      750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> year  2014  <span style="color: #949494;">"</span>10/750 (1%) <span style="color: #949494;">"</span>      750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> year  2015  <span style="color: #949494;">"</span> 8/750 (1%) <span style="color: #949494;">"</span>      750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> year  2016  <span style="color: #949494;">"</span>15/750 (2%) <span style="color: #949494;">"</span>      750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> year  2017  <span style="color: #949494;">"</span>116/750 (15%)<span style="color: #949494;">"</span>     750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> year  2018  <span style="color: #949494;">"</span>150/750 (20%)<span style="color: #949494;">"</span>     750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> year  2019  <span style="color: #949494;">"</span>116/750 (15%)<span style="color: #949494;">"</span>     750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> year  2020  <span style="color: #949494;">"</span>72/750 (10%)<span style="color: #949494;">"</span>      750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> year  2021  <span style="color: #949494;">"</span>99/750 (13%)<span style="color: #949494;">"</span>      750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> year  2022  <span style="color: #949494;">"</span>119/750 (16%)<span style="color: #949494;">"</span>     750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> year  2023  <span style="color: #949494;">"</span>41/750 (5%) <span style="color: #949494;">"</span>      750</span></span></code></pre></div>
<p>The error message “Too many levels detected in year” is intentional,
to avoid passing continuous variables in the <code>vf</code>
argument.</p>
<p>The maximum number of categories that can be taken by a variable
treated by <code>desc_facvar</code> is controlled by the
<code>ncat_max</code> argument.</p>
<p>If a variable has more than <code>ncat_max</code> different levels,
the function stops.</p>
<p>We can therefore solve this problem by adjusting the value of this
parameter.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/desc_facvar.html">desc_facvar</a></span><span class="op">(</span></span>
<span>  .data <span class="op">=</span> <span class="va">demo</span>,</span>
<span>  vf <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>  ncat_max <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 13 × 4</span></span></span>
<span><span class="co">#&gt;    var   level value           n_avail</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> year  2011  <span style="color: #949494;">"</span> 1/750 (0%) <span style="color: #949494;">"</span>      750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> year  2012  <span style="color: #949494;">"</span> 1/750 (0%) <span style="color: #949494;">"</span>      750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> year  2013  <span style="color: #949494;">"</span> 2/750 (0%) <span style="color: #949494;">"</span>      750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> year  2014  <span style="color: #949494;">"</span>10/750 (1%) <span style="color: #949494;">"</span>      750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> year  2015  <span style="color: #949494;">"</span> 8/750 (1%) <span style="color: #949494;">"</span>      750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> year  2016  <span style="color: #949494;">"</span>15/750 (2%) <span style="color: #949494;">"</span>      750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> year  2017  <span style="color: #949494;">"</span>116/750 (15%)<span style="color: #949494;">"</span>     750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> year  2018  <span style="color: #949494;">"</span>150/750 (20%)<span style="color: #949494;">"</span>     750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> year  2019  <span style="color: #949494;">"</span>116/750 (15%)<span style="color: #949494;">"</span>     750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> year  2020  <span style="color: #949494;">"</span>72/750 (10%)<span style="color: #949494;">"</span>      750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> year  2021  <span style="color: #949494;">"</span>99/750 (13%)<span style="color: #949494;">"</span>      750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> year  2022  <span style="color: #949494;">"</span>119/750 (16%)<span style="color: #949494;">"</span>     750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> year  2023  <span style="color: #949494;">"</span>41/750 (5%) <span style="color: #949494;">"</span>      750</span></span></code></pre></div>
<p>This allows to review the main years, but will be less transposable
in a final table of a manuscript. A categorization of the reporting
years may be more informative.</p>
</div>
<div class="section level3">
<h3 id="explicit-categorical-variables">Explicit categorical variables<a class="anchor" aria-label="anchor" href="#explicit-categorical-variables"></a>
</h3>
<p>Levels of some variables are indicated by numbers.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/desc_facvar.html">desc_facvar</a></span><span class="op">(</span></span>
<span>  .data <span class="op">=</span> <span class="va">demo</span>,</span>
<span>  vf <span class="op">=</span> <span class="st">"Region"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt;   var    level value           n_avail</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Region 1     <span style="color: #949494;">"</span> 1/750 (0%) <span style="color: #949494;">"</span>      750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Region 2     <span style="color: #949494;">"</span>389/750 (52%)<span style="color: #949494;">"</span>     750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Region 3     <span style="color: #949494;">"</span>17/750 (2%) <span style="color: #949494;">"</span>      750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Region 4     <span style="color: #949494;">"</span>276/750 (37%)<span style="color: #949494;">"</span>     750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Region 5     <span style="color: #949494;">"</span> 6/750 (1%) <span style="color: #949494;">"</span>      750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Region 6     <span style="color: #949494;">"</span>61/750 (8%) <span style="color: #949494;">"</span>      750</span></span></code></pre></div>
<p>We know that 389 cases come from Region “2”, without being able to
say which geographical area this region belongs to.</p>
<p>To obtain the correspondence, there are external tables, such as this
one for the Region: (they can be found in the subsidiary tables of
vigibase).</p>
<table class="table">
<thead><tr class="header">
<th>Code</th>
<th>Label</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>African Region</td>
</tr>
<tr class="even">
<td>2</td>
<td>Region of the Americas</td>
</tr>
<tr class="odd">
<td>3</td>
<td>South-East Asia Region</td>
</tr>
<tr class="even">
<td>4</td>
<td>European Region</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Eastern Mediterranean Region</td>
</tr>
<tr class="even">
<td>6</td>
<td>Western Pacific Region</td>
</tr>
</tbody>
</table>
<p>Several options are possible to bring the information back directly
into demo, the simplest is to use factors</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">demo</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">demo</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Region</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"6"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">demo</span><span class="op">$</span><span class="va">Region</span><span class="op">)</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"African Region"</span>,                                    </span>
<span>    <span class="st">"Region of the Americas"</span>,                            </span>
<span>    <span class="st">"South-East Asia Region"</span>,                            </span>
<span>    <span class="st">"European Region"</span>,                                   </span>
<span>    <span class="st">"Eastern Mediterranean Region"</span>,                      </span>
<span>    <span class="st">"Western Pacific Region"</span>  </span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Note the transformation in two steps. The first to sort the levels of
the variable, the second to assign the labels to its levels. This
sequence is necessary to avoid a random sorting of levels.</p>
<p>This transformation has the effect of modifying the result of
<code><a href="../reference/desc_facvar.html">desc_facvar()</a></code></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/desc_facvar.html">desc_facvar</a></span><span class="op">(</span></span>
<span>  .data <span class="op">=</span> <span class="va">demo</span>,</span>
<span>  vf <span class="op">=</span> <span class="st">"Region"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt;   var    level                        value           n_avail</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Region African Region               <span style="color: #949494;">"</span> 1/750 (0%) <span style="color: #949494;">"</span>      750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Region Region of the Americas       <span style="color: #949494;">"</span>389/750 (52%)<span style="color: #949494;">"</span>     750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Region South-East Asia Region       <span style="color: #949494;">"</span>17/750 (2%) <span style="color: #949494;">"</span>      750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Region European Region              <span style="color: #949494;">"</span>276/750 (37%)<span style="color: #949494;">"</span>     750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Region Eastern Mediterranean Region <span style="color: #949494;">"</span> 6/750 (1%) <span style="color: #949494;">"</span>      750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Region Western Pacific Region       <span style="color: #949494;">"</span>61/750 (8%) <span style="color: #949494;">"</span>      750</span></span></code></pre></div>
<p>The two other variables mainly affected by this phenomenon are
<code>Type</code> and <code>type_reporter</code>. The transformation
code is found in <code>vignette("template_main.R")</code></p>
</div>
<div class="section level3">
<h3 id="other-arguments-of-desc_facvar">Other arguments of <code>desc_facvar()</code><a class="anchor" aria-label="anchor" href="#other-arguments-of-desc_facvar"></a>
</h3>
<p>Three other arguments allow to control the output format of the
results.</p>
<ol style="list-style-type: decimal">
<li>
<code>format</code> is a character string that must necessarily
contain the values <code>n</code>, <code>N</code> and
<code>pc</code>.</li>
</ol>
<p>This argument allows to customize the way the result is displayed.
For example, if you want to put the percentage in brackets instead of
parentheses</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/desc_facvar.html">desc_facvar</a></span><span class="op">(</span></span>
<span>  .data <span class="op">=</span> <span class="va">demo</span>,</span>
<span>  vf <span class="op">=</span> <span class="st">"nivolumab"</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"n_/N_ [pc_%]"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">#&gt;   var       level value         n_avail</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> nivolumab 0     525/750 [70%]     750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> nivolumab 1     225/750 [30%]     750</span></span></code></pre></div>
<p>You can also change all other elements of this argument.</p>
<ol start="2" style="list-style-type: decimal">
<li><p><code>pad_width</code> allows to center the results in the middle
of a character string. If you have particularly high numbers, you can
increase the value of this parameter, so that your results remain well
centered.</p></li>
<li><p><code>digits</code> controls the number of digits after the
decimal point for the percentage. <strong>Warning</strong>, it is not
guaranteed that the sum will be exactly 100%.</p></li>
</ol>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/desc_facvar.html">desc_facvar</a></span><span class="op">(</span></span>
<span>  .data <span class="op">=</span> <span class="va">demo</span>,</span>
<span>  vf <span class="op">=</span> <span class="st">"nivolumab"</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">#&gt;   var       level value           n_avail</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> nivolumab 0     525/750 (70.0%)     750</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> nivolumab 1     225/750 (30.0%)     750</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="drug-data-drug-screening">Drug data: drug screening<a class="anchor" aria-label="anchor" href="#drug-data-drug-screening"></a>
</h2>
</div>
<div class="section level2">
<h2 id="adr-data-adr-screening-and-evolution-of-adverse-events">Adr data: adr screening and evolution of adverse events<a class="anchor" aria-label="anchor" href="#adr-data-adr-screening-and-evolution-of-adverse-events"></a>
</h2>
<p><code><a href="../reference/screen_drug.html">screen_drug()</a></code> let you screen the most drugs reported in
a <code>drug</code> dataset, sorted by frequency.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/screen_drug.html">screen_drug</a></span><span class="op">(</span><span class="va">drug</span>, mp_data <span class="op">=</span> <span class="va">mp</span>, top_n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 4</span></span></span>
<span><span class="co">#&gt;   `Drug name`      DrecNo     N percentage</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> pembrolizumab  20<span style="text-decoration: underline;">116</span>296   298      39.7 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> nivolumab     111<span style="text-decoration: underline;">841</span>511   225      30   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> ipilimumab    133<span style="text-decoration: underline;">138</span>448    86      11.5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> atezolizumab  112<span style="text-decoration: underline;">765</span>189    69       9.2 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> durvalumab    125<span style="text-decoration: underline;">456</span>180    68       9.07</span></span></code></pre></div>
<p>Most of the time, you will have filtered the <code>drug</code> data
upstream, with some <code>add_*</code> function, allowing to focus on a
subset of cases (of a specific drug, adr, or any set of these)</p>
<p>For example, identify colitis cases and screen drugs under this
reaction.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">drug</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_adr.html">add_adr</a></span><span class="op">(</span></span>
<span>    <span class="va">a_llt</span>,</span>
<span>    adr_data <span class="op">=</span> <span class="va">adr</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">a_colitis</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/screen_drug.html">screen_drug</a></span><span class="op">(</span></span>
<span>    mp_data <span class="op">=</span> <span class="va">mp</span>, top_n <span class="op">=</span> <span class="fl">5</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> `.data` detected as `drug` table.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 4</span></span></span>
<span><span class="co">#&gt;   `Drug name`      DrecNo     N percentage</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> nivolumab     111<span style="text-decoration: underline;">841</span>511    44       42.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> pembrolizumab  20<span style="text-decoration: underline;">116</span>296    40       38.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> ipilimumab    133<span style="text-decoration: underline;">138</span>448    20       19.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> <span style="color: #BB0000;">NA</span>             73<span style="text-decoration: underline;">636</span>724    14       13.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> <span style="color: #BB0000;">NA</span>             34<span style="text-decoration: underline;">178</span>924    13       12.5</span></span></code></pre></div>
<div class="section level3">
<h3 id="adr-screening">Adr screening<a class="anchor" aria-label="anchor" href="#adr-screening"></a>
</h3>
<p><code><a href="../reference/screen_adr.html">screen_adr()</a></code> let you screen the most frequent reactions
reported in an <code>adr</code> dataset, sorted by frequency.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/screen_adr.html">screen_adr</a></span><span class="op">(</span><span class="va">adr_</span>, meddra <span class="op">=</span> <span class="va">meddra_</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                               term     n percentage</span></span>
<span><span class="co">#&gt;                                             &lt;char&gt; &lt;int&gt;      &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:                                            &lt;NA&gt;   678 90.4000000</span></span>
<span><span class="co">#&gt; 2: Respiratory, thoracic and mediastinal disorders   110 14.6666667</span></span>
<span><span class="co">#&gt; 3:                      Gastrointestinal disorders   104 13.8666667</span></span>
<span><span class="co">#&gt; 4:                              Vascular disorders     9  1.2000000</span></span>
<span><span class="co">#&gt; 5:                         Immune system disorders     6  0.8000000</span></span>
<span><span class="co">#&gt; 6:                         Hepatobiliary disorders     5  0.6666667</span></span>
<span><span class="co">#&gt; 7:          Skin and subcutaneous tissue disorders     1  0.1333333</span></span></code></pre></div>
<p>Different term levels can be used, according to meddra, with argument
<code>term_level</code>.</p>
<p>Most of the time, you will have filtered the <code>adr</code> data
upstream, with some <code>add_*</code> function, allowing to focus on a
subset of cases (of a specific drug, adr, or any set of these).</p>
</div>
<div class="section level3">
<h3 id="outcome">Outcome<a class="anchor" aria-label="anchor" href="#outcome"></a>
</h3>
<p>The adr table contains information on the evolution of adverse
events.</p>
<p>The possible outcomes (column <code>Outcome</code>) are</p>
<ul>
<li>Recovered/resolved</li>
<li>Recovering/resolving</li>
<li>Recovered/resolved with sequelae</li>
<li>Not recovered/not resolved</li>
<li>Fatal</li>
<li>Died- unrelated to reaction</li>
<li>Died- reaction may be contributory</li>
</ul>
<p>The adr structure is as follows</p>
<table class="table">
<thead><tr class="header">
<th>UMCReportId</th>
<th>Adr_Id</th>
<th>Outcome</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>a_1</td>
<td>1</td>
</tr>
<tr class="even">
<td>1</td>
<td>a_2</td>
<td>2</td>
</tr>
<tr class="odd">
<td>2</td>
<td>a_3</td>
<td>3</td>
</tr>
<tr class="even">
<td>2</td>
<td>a_4</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>A case, identified by its UMCReportId, may have several adverse
events (Adr_Id) with different outcomes. Summarizing this information
requires prioritization.</p>
<p>The logic is as follows: take the ” worst evolution” possible for
each event of each case, in order to count each event only once for each
case.</p>
<p>In order to filter cases according to a drug exposition, it is
necessary to join the drug data to the adr table.</p>
</div>
<div class="section level3">
<h3 id="step-1-data-management-of-adr-with-add_drug-and-add_adr">Step 1: Data management of adr with add_drug and add_adr<a class="anchor" aria-label="anchor" href="#step-1-data-management-of-adr-with-add_drug-and-add_adr"></a>
</h3>
<p><code><a href="../reference/add_drug.html">add_drug()</a></code> and <code><a href="../reference/add_adr.html">add_adr()</a></code> can be used on
<code>adr</code> data.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">adr</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">adr</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_drug.html">add_drug</a></span><span class="op">(</span></span>
<span>    d_code <span class="op">=</span> <span class="va">d_drecno</span>,</span>
<span>    drug_data <span class="op">=</span> <span class="va">drug</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> `.data` detected as `adr` table.</span></span>
<span></span>
<span><span class="va">adr</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">adr</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_adr.html">add_adr</a></span><span class="op">(</span></span>
<span>    a_code <span class="op">=</span> <span class="va">a_llt</span>,</span>
<span>    adr_data <span class="op">=</span> <span class="va">adr</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> `.data` detected as `adr` table.</span></span></code></pre></div>
<p>This allows to identify drugs and adverse events of interest in the
adr table.</p>
<p>Drugs are identified at the case level in this table.</p>
</div>
<div class="section level3">
<h3 id="step-2-desc_outcome-function">Step 2: <code>desc_outcome()</code> function<a class="anchor" aria-label="anchor" href="#step-2-desc_outcome-function"></a>
</h3>
<p>The <code>desc_outcome</code> function prioritizes data according to
the rule:</p>
<blockquote>
<p>Take the “worst evolution” possible for each event of each case, in
order to count each event only once for each case.</p>
</blockquote>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adr</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/desc_outcome.html">desc_outcome</a></span><span class="op">(</span></span>
<span>    drug_s <span class="op">=</span> <span class="st">"nivolumab"</span>,</span>
<span>    adr_s <span class="op">=</span> <span class="st">"a_colitis"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 4</span></span></span>
<span><span class="co">#&gt;   drug_s    adr_s     n_cas out_label                 </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> nivolumab a_colitis    10 Unknown                   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> nivolumab a_colitis    25 Recovered/resolved        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> nivolumab a_colitis     6 Recovering/resolving      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> nivolumab a_colitis     1 Not recovered/not resolved</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> nivolumab a_colitis     2 Fatal</span></span></code></pre></div>
<p>In the case where <code>adr</code> was previously filtered to contain
only data of a specific adverse drug reaction (for example, with
<code><a href="../reference/tb_subset.html">tb_subset()</a></code>), it is still preferable to recreate the drug
column with <code>add_drug</code> (it will take the value 1 for all
cases).</p>
</div>
</div>
<div class="section level2">
<h2 id="link-data-time-to-onset-dechallenge-rechallenge">Link data: time to onset, dechallenge, rechallenge<a class="anchor" aria-label="anchor" href="#link-data-time-to-onset-dechallenge-rechallenge"></a>
</h2>
<p>The link table, as created with <code><a href="../reference/tb_vigibase.html">tb_vigibase()</a></code>, contains
additional information than the original link table.</p>
<p>It is augmented with</p>
<ul>
<li>
<code>UMCReportId</code> the case id</li>
<li>
<code>tto_mean</code> the average of TimeToOnsetMin, and
TimeToOnsetMax, in days</li>
<li>
<code>range</code> the half-difference between TimeToOnsetMin and
TimeToOnsetMax, in days</li>
</ul>
<p>These additional variables are useful to compute the time from drug
initiation to adverse drug reaction onset, and also to compute
dechallenge and rechallenge data at case level.</p>
<div class="section level3">
<h3 id="step-1-load-the-datasets">Step 1: Load the datasets<a class="anchor" aria-label="anchor" href="#step-1-load-the-datasets"></a>
</h3>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">link</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">link_</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-2-add-drug-and-adr-columns">Step 2: Add drug and adr columns<a class="anchor" aria-label="anchor" href="#step-2-add-drug-and-adr-columns"></a>
</h3>
<p>The link table studies the relationship of each drug - adverse event
pair, within the reports. There are therefore several lines in link for
each line (case) in demo.</p>
<p><code>demo</code> table example</p>
<table class="table">
<thead><tr class="header">
<th>UMCReportId</th>
<th>Other data (age, sexe…)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>65-74, Man</td>
</tr>
<tr class="even">
<td>2</td>
<td>65-74, Woman</td>
</tr>
<tr class="odd">
<td>3</td>
<td>45-64, Woman</td>
</tr>
</tbody>
</table>
<p>The corresponding <code>link</code> table would be</p>
<table class="table">
<thead><tr class="header">
<th>UMCReportId</th>
<th>Drug_Id</th>
<th>Adr_Id</th>
<th>Time to onset</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1_1</td>
<td>1_a</td>
<td>60</td>
</tr>
<tr class="even">
<td>1</td>
<td>1_2</td>
<td>1_a</td>
<td>30</td>
</tr>
<tr class="odd">
<td>1</td>
<td>1_1</td>
<td>1_b</td>
<td>45</td>
</tr>
<tr class="even">
<td>1</td>
<td>1_2</td>
<td>1_b</td>
<td>15</td>
</tr>
<tr class="odd">
<td>2</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>2</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>3</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>3</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>3</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="learn-the-content-of-link">Learn the content of link<a class="anchor" aria-label="anchor" href="#learn-the-content-of-link"></a>
</h3>
<p>Let’s take a while to read data related to the case no 1, in the
previous example.</p>
<ul>
<li><p>It contains two different Drug_Id <code>1_1</code> and
<code>1_2</code>: this means that this case has two different drugs.
Most of the time, it is two different drugs (let’s say, paracetamol and
ibuprofen for this example). It can also be the same drug, with
different administration modalities (paracetamol with two dosages, or at
two different times).</p></li>
<li><p>It contains two different Adr_Id <code>1_a</code> and
<code>1_b</code>: this means that this case has two different adverse
events. Mostly, it refers to two different events (e.g. hepatitis and
hemorrhage).</p></li>
<li><p>Information are available for each combination. The time to
onset, i.e. the delay between drug initiation and event onset is
displayed for each combination</p></li>
</ul>
<p>The reading is as follows:</p>
<ul>
<li><p>The hepatitis (<code>1_a</code>) occurred 60 days after the
introduction of paracetamol (<code>1_1</code>), and 30 days after the
introduction of ibuprofen (<code>1_2</code>).</p></li>
<li><p>The hemorrhage (<code>1_b</code>) occurred 45 days after the
introduction of paracetamol (<code>1_1</code>), and 15 days after the
introduction of ibuprofen (<code>1_2</code>).</p></li>
</ul>
<p>In this relatively simple example, everything is coherent: we observe
that paracetamol and ibuprofen were introduced 30 days apart from each
other.</p>
<p>The reality is often more complex: as previously announced, there may
be several lines in <code>link</code>for the same drug, with different
time to onset.</p>
<p>In this case, it is important to decide how to handle this multiple
information.</p>
<p>For example, we could have a time to onset at 30 days for paracetamol
taken at 500mg daily, and a time to onset at 15 days for paracetamol
taken at 1000mg daily.</p>
</div>
<div class="section level3">
<h3 id="identify-drugs-and-adverse-events">Identify drugs and adverse events<a class="anchor" aria-label="anchor" href="#identify-drugs-and-adverse-events"></a>
</h3>
<p>As for the <code>demo</code> and <code>adr</code> tables, the
<code>link</code> table must be completed with drug and adr columns,
using the <code>add_*</code> family functions.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">link</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">link</span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu"><a href="../reference/add_drug.html">add_drug</a></span><span class="op">(</span></span>
<span>    d_code <span class="op">=</span> <span class="va">d_drecno</span>,</span>
<span>    drug_data <span class="op">=</span> <span class="va">drug</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> `.data` detected as `link` table.</span></span>
<span></span>
<span><span class="va">link</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">link</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_adr.html">add_adr</a></span><span class="op">(</span></span>
<span>    a_code <span class="op">=</span> <span class="va">a_llt</span>,</span>
<span>    adr_data <span class="op">=</span> <span class="va">adr</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> `.data` detected as `link` table.</span></span></code></pre></div>
<p>Counts check</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">link</span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu"><a href="../reference/check_dm.html">check_dm</a></span><span class="op">(</span></span>
<span>     cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">d_drecno</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">a_llt</span><span class="op">)</span><span class="op">)</span></span>
<span>     <span class="op">)</span></span>
<span><span class="co">#&gt;               [,1]</span></span>
<span><span class="co">#&gt; ipilimumab     267</span></span>
<span><span class="co">#&gt; atezolizumab   189</span></span>
<span><span class="co">#&gt; durvalumab     166</span></span>
<span><span class="co">#&gt; nivolumab     1347</span></span>
<span><span class="co">#&gt; pembrolizumab 1819</span></span>
<span><span class="co">#&gt; avelumab        83</span></span>
<span><span class="co">#&gt; cemiplimab      38</span></span>
<span><span class="co">#&gt; tremelimumab    35</span></span>
<span><span class="co">#&gt; a_embolism      38</span></span>
<span><span class="co">#&gt; a_colitis      314</span></span>
<span><span class="co">#&gt; a_pneumonitis  238</span></span></code></pre></div>
<p><strong>!! Warning!!</strong>, counts correspond to the number of
lines for each drug and each effect. It is not the number of reports
containing each drug or each effect. If you want to obtain this
information, you must query the <code>demo</code> table.</p>
</div>
<div class="section level3">
<h3 id="time-to-onset">Time to onset<a class="anchor" aria-label="anchor" href="#time-to-onset"></a>
</h3>
<p>The time to onset information is contained in two variables in the
<code>link</code> table: <code>TimeToOnsetMin</code> and
<code>TimeToOnsetMax</code>. These two variables reflect the minimum and
maximum delay of the adverse event occurrence compared to the drug
intake, taking into account the uncertainty of the input data.</p>
<table class="table">
<thead><tr class="header">
<th>UMCReportId</th>
<th>Drug_Id</th>
<th>Adr_Id</th>
<th>TimeToOnsetMin</th>
<th>TimeToOnsetMax</th>
</tr></thead>
<tbody><tr class="odd">
<td>1</td>
<td>1_1</td>
<td>1_a</td>
<td>45</td>
<td>75</td>
</tr></tbody>
</table>
<p>Here, hepatitis occurred between 45 and 75 days after first
paracetamol intake.</p>
<p>This structure is inherited of the incertitude from the source
reporter or the case. This case would correspond to data like:
“Hepatitis occurred 2months after paracetamol introduction”.</p>
<p>This sentence contains an imprecision on the exact delay of
occurrence: what was the exact day of the month? Was it 1 month and 15
days? Or 2 months and 15 days? More? It is impossible to decide.</p>
<p>By convention, we consider that the true time to onset is +/- 15 days
from the indicated date (here, between 60 - 15 = 45 days, and 60 + 15 =
75 days).</p>
<p>Two parameters are derived from this information: the mean time to
onset <code>tto_mean</code> and the <code>range</code>. The calculation
is as follows:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tto_mean</span> <span class="op">=</span> <span class="op">(</span><span class="va">TimeToOnsetMax</span> <span class="op">+</span> <span class="va">TimeToOnsetMin</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span></span>
<span><span class="va">range</span> <span class="op">=</span> <span class="op">(</span><span class="va">TimeToOnsetMax</span> <span class="op">+</span> <span class="va">TimeToOnsetMin</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span> <span class="op">-</span> <span class="va">TimeToOnsetMin</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="14%">
<col width="14%">
<col width="14%">
<col width="14%">
<col width="14%">
<col width="14%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th>UMCReportId</th>
<th>Drug_Id</th>
<th>Adr_Id</th>
<th>TimeToOnsetMin</th>
<th>TimeToOnsetMax</th>
<th>tto_mean</th>
<th>range</th>
</tr></thead>
<tbody><tr class="odd">
<td>1</td>
<td>1_1</td>
<td>1_a</td>
<td>45</td>
<td>75</td>
<td>60</td>
<td>30</td>
</tr></tbody>
</table>
<p>The <code>tto_mean</code> is intuitive: it is the average delay
between the two available values. In our example, we find 60 days, which
is the delay indicated by the reporter.</p>
<p>The <code>range</code> gives the uncertainty: 30 days in our example,
meaning that we cannot be more precise than 30 days.</p>
<blockquote>
<p>The Uppsala Monitoring Centre recommendation is to use only the time
to onset whose range is &lt;= 1, i.e. the cases where the date is known
to the day.</p>
</blockquote>
<p>Note: the information on hours and minutes is also present in the
time to onset, if known.</p>
<p>If we keep on the example of hepatitis, we could have a time to onset
at 30 days for paracetamol taken at 500mg daily, and a time to onset at
15 days for paracetamol taken at 1000mg daily.</p>
<p>In this case, it is important to decide how to handle this multiple
information. Otherwise, we would have two different
<code>tto_mean</code> values for the paracetamol - hepatitis pair.</p>
<p>There is a need for an arbitrary rule to synthetize these data. Our
habit is to <strong>take the longest delay</strong> between the drug
introduction and the event occurrence (i.e. the delay between the first
drug intake and the event). Admittedly, this may not meet all needs.</p>
<p>This information, that we call <code>tto_max</code>, is obtained with
<code><a href="../reference/extract_tto.html">extract_tto()</a></code>.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/extract_tto.html">extract_tto</a></span><span class="op">(</span></span>
<span>  .data <span class="op">=</span> <span class="va">link</span>,</span>
<span>  drug_s <span class="op">=</span> <span class="st">"nivolumab"</span>,</span>
<span>  adr_s  <span class="op">=</span> <span class="st">"a_colitis"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    UMCReportId tto_max     adr_s    drug_s</span></span>
<span><span class="co">#&gt; 1    108846594     205 a_colitis nivolumab</span></span>
<span><span class="co">#&gt; 2     73027866     175 a_colitis nivolumab</span></span>
<span><span class="co">#&gt; 3     87966085      36 a_colitis nivolumab</span></span>
<span><span class="co">#&gt; 4     88371745     740 a_colitis nivolumab</span></span>
<span><span class="co">#&gt; 5    138643678     379 a_colitis nivolumab</span></span>
<span><span class="co">#&gt; 6     39936658      99 a_colitis nivolumab</span></span>
<span><span class="co">#&gt; 7    140765885       5 a_colitis nivolumab</span></span>
<span><span class="co">#&gt; 8     11372968      62 a_colitis nivolumab</span></span>
<span><span class="co">#&gt; 9     63102481      57 a_colitis nivolumab</span></span>
<span><span class="co">#&gt; 10    34209616       8 a_colitis nivolumab</span></span>
<span><span class="co">#&gt; 11    21293261      59 a_colitis nivolumab</span></span>
<span><span class="co">#&gt; 12    58329610     541 a_colitis nivolumab</span></span>
<span><span class="co">#&gt; 13    38269558     393 a_colitis nivolumab</span></span>
<span><span class="co">#&gt; 14    85691581     490 a_colitis nivolumab</span></span>
<span><span class="co">#&gt; 15   112663221       7 a_colitis nivolumab</span></span>
<span><span class="co">#&gt; 16   109716692      37 a_colitis nivolumab</span></span>
<span><span class="co">#&gt; 17    56986472      47 a_colitis nivolumab</span></span>
<span><span class="co">#&gt; 18    76401465     390 a_colitis nivolumab</span></span>
<span><span class="co">#&gt; 19   125056616      18 a_colitis nivolumab</span></span>
<span><span class="co">#&gt; 20    33942691      36 a_colitis nivolumab</span></span>
<span><span class="co">#&gt; 21   133088642      23 a_colitis nivolumab</span></span>
<span><span class="co">#&gt; 22   143881598     113 a_colitis nivolumab</span></span>
<span><span class="co">#&gt; 23    79620779      85 a_colitis nivolumab</span></span>
<span><span class="co">#&gt; 24    95759941      59 a_colitis nivolumab</span></span></code></pre></div>
<p>The <code>tto_max</code> is the longest delay between the drug
introduction and the event occurrence. There is only one line for each
drug - adr pair.</p>
<p>This information can be used for a graphical representation, or to
derive an average, a range… The second option is possible in many ways,
notably with <code><a href="../reference/desc_tto.html">desc_tto()</a></code>.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/desc_tto.html">desc_tto</a></span><span class="op">(</span></span>
<span>  .data <span class="op">=</span> <span class="va">link</span>,</span>
<span>  drug_s <span class="op">=</span> <span class="st">"nivolumab"</span>,</span>
<span>  adr_s  <span class="op">=</span> <span class="st">"a_colitis"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;      drug_s     adr_s     var level                         value n_avail</span></span>
<span><span class="co">#&gt; 1 nivolumab a_colitis tto_max  &lt;NA&gt; 60.5 (36.0-248.5) [5.0-740.0]      24</span></span></code></pre></div>
<p>Several drugs and reactions can be queried in these two
functions.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/desc_tto.html">desc_tto</a></span><span class="op">(</span></span>
<span>  .data <span class="op">=</span> <span class="va">link</span>,</span>
<span>  drug_s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nivolumab"</span>, <span class="st">"pembrolizumab"</span><span class="op">)</span>,</span>
<span>  adr_s  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a_colitis"</span>, <span class="st">"a_pneumonitis"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;          drug_s         adr_s     var level                           value</span></span>
<span><span class="co">#&gt; 1     nivolumab     a_colitis tto_max  &lt;NA&gt;   60.5 (36.0-248.5) [5.0-740.0]</span></span>
<span><span class="co">#&gt; 2 pembrolizumab     a_colitis tto_max  &lt;NA&gt; 44.0 (18.5-112.5) [1.0-1,207.0]</span></span>
<span><span class="co">#&gt; 3     nivolumab a_pneumonitis tto_max  &lt;NA&gt;  75.0 (49.8-167.0) [18.0-602.0]</span></span>
<span><span class="co">#&gt; 4 pembrolizumab a_pneumonitis tto_max  &lt;NA&gt; 52.0 (21.0-101.0) [0.0-1,050.0]</span></span>
<span><span class="co">#&gt;   n_avail</span></span>
<span><span class="co">#&gt; 1      24</span></span>
<span><span class="co">#&gt; 2      15</span></span>
<span><span class="co">#&gt; 3      22</span></span>
<span><span class="co">#&gt; 4      17</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dechallenge">Dechallenge<a class="anchor" aria-label="anchor" href="#dechallenge"></a>
</h3>
<p><code><a href="../reference/desc_dch.html">desc_dch()</a></code> synthesizes the number of positive
dechallenges:</p>
<blockquote>
<p>A positive dechallenge occurs when the drug has been stopped or its
dosage has been reduced, and the reaction has abatted.</p>
</blockquote>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/desc_dch.html">desc_dch</a></span><span class="op">(</span></span>
<span>  <span class="va">link</span>,</span>
<span>  drug_s <span class="op">=</span> <span class="st">"nivolumab"</span>,</span>
<span>  adr_s  <span class="op">=</span> <span class="st">"a_colitis"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;      drug_s     adr_s pos_dch</span></span>
<span><span class="co">#&gt; 1 nivolumab a_colitis      27</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/desc_dch.html">desc_dch</a></span><span class="op">(</span></span>
<span>  <span class="va">link</span>,</span>
<span>  drug_s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nivolumab"</span>, <span class="st">"pembrolizumab"</span><span class="op">)</span>,</span>
<span>  adr_s  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a_colitis"</span>, <span class="st">"a_pneumonitis"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;          drug_s         adr_s pos_dch</span></span>
<span><span class="co">#&gt; 1     nivolumab     a_colitis      27</span></span>
<span><span class="co">#&gt; 2 pembrolizumab     a_colitis      19</span></span>
<span><span class="co">#&gt; 3     nivolumab a_pneumonitis      22</span></span>
<span><span class="co">#&gt; 4 pembrolizumab a_pneumonitis      26</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="rechallenge">Rechallenge<a class="anchor" aria-label="anchor" href="#rechallenge"></a>
</h3>
<p>Description span from rechallenge cases to informative rechallenge
cases (those cases where the outcome is known). Drug and Adr identifiers
refer to DrecNo and MedDRA_Id, respectively. Terminology</p>
<ul>
<li><p><code>overall</code> as opposed to <code>rch</code> for
rechallenged (<code>rch</code> + <code>no_rch</code> =
<code>overall</code>).</p></li>
<li><p>Among <code>rch</code>, <code>inf</code> (informative) as opposed
to <code>non_inf</code> (<code>inf</code> + <code>non_inf</code> =
<code>rch</code>)</p></li>
<li><p>Among <code>inf</code>, <code>rec</code> (recurring) as opposed
to <code>non_rec</code> (<code>rec</code> + <code>non_rec</code> =
<code>inf</code>)</p></li>
</ul>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/desc_rch.html">desc_rch</a></span><span class="op">(</span></span>
<span>  <span class="va">link</span>,</span>
<span>  drug_s <span class="op">=</span> <span class="st">"nivolumab"</span>,</span>
<span>  adr_s  <span class="op">=</span> <span class="st">"a_colitis"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;       drug_s     adr_s n_overall n_rch n_inf n_rec</span></span>
<span><span class="co">#&gt;       &lt;char&gt;    &lt;char&gt;     &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1: nivolumab a_colitis        44    26    19    12</span></span></code></pre></div>
<p><strong>The number of cases is counted at the case
level.</strong></p>
<p>As with <code><a href="../reference/desc_tto.html">desc_tto()</a></code> and <code><a href="../reference/desc_dch.html">desc_dch()</a></code>, you can
query several drug - adr pairs at once.</p>
<blockquote>
<p>Columns passed to arguments <code>drug_s</code> and
<code>adr_s</code> can correspond to sets of drugs or events, or even
identify all cases present in your dataset.</p>
</blockquote>
<p>Let’s say we want to know the number of positive rechallenge cases
for our entire dataset</p>
<p>We must create a variable that takes the value 1 for all cases.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">link</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">link</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    all_cases <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>We a particular syntax, we can access the information</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/desc_rch.html">desc_rch</a></span><span class="op">(</span></span>
<span>  <span class="va">link</span>,</span>
<span>  drug_s <span class="op">=</span> <span class="st">"all_cases"</span>,</span>
<span>  adr_s  <span class="op">=</span> <span class="st">"all_cases"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;       drug_s     adr_s n_overall n_rch n_inf n_rec</span></span>
<span><span class="co">#&gt;       &lt;char&gt;    &lt;char&gt;     &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1: all_cases all_cases       707   297   106    28</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Charles Dolladille, Basile Chrétien.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
